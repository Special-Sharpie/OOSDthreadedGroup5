<!-- packagesmysql.ejs -->
<!-- Lists availible travel packages generated using data from the travelexperts SQL database -->
<!-- Author: Marat Nikitin -->
<!-- Co-author: Daniel Palmer -->
<!-- CPRG 207 - Threaded Project -->
<!-- 2021-11-30 -->

<!DOCTYPE html>
<html>
	<head>
		<link rel="preconnect" href="https://fonts.googleapis.com">
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
		<link href="https://fonts.googleapis.com/css2?family=Montserrat&family=Roboto&display=swap" rel="stylesheet">

		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
		<link rel="icon" href="gator.png" />
		<meta charset="UTF-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<link rel="stylesheet" href="index.css">		 
		<link rel="stylesheet" type="text/css" href="packages.css" />	
		<link rel="stylesheet" href="headfoot.css">
		<link rel="icon" type="image/x-icon" href="favicon.png">
		<script src="https://kit.fontawesome.com/333efb0c4e.js" crossorigin="anonymous"></script>
		<title> Packages - Travel Agents </title>
	</head>
	<body>

		<%- include("header") %>

		<h1> Our best packages for you: </h1>
		<div class="main-content">
		<!-- A table with data from the travelexperts MySQL database is displayed: -->
		<table class="table">
			<!-- A row with customised column header names is created and displayed: -->
			<% let tableHeaders = ["Package Name", "Start Date", "End Date", "Description", 
			"Package Price, CAD", "Order a Package"];%> <!-- Created an array of table headers here, the last column 
					from the database's packages table (agency's commission) was intentionally replaced by order buttons. -->
				<tr>
				<% for (let key in tableHeaders) { %>
					<% if (tableHeaders.hasOwnProperty(key)) { %>
						<th><%= tableHeaders[key] %></th>
					<% } %>
				<% } %>
				</tr>
			<!-- Rows of information about packages are retrieved from the database and displayed dynamically: -->	
			<% for (let customer of result) { %>
				<tr>
				<% for (let key in customer) { %>
					<%  if (customer.hasOwnProperty(key)) { %>
						<% if (Array.isArray(customer[key])){ %>
							<td style = "color: <%= customer[key][1]%>; font-weight: <%= customer[key][2] %>;">
								<%= customer[key][0]%>
							</td>							
						<% } else { %>						
							<td><%= customer[key] %></td>
						<% } %>
					<%	} %>
				<% } %>
				<td>
					<a href="/order"><button class="btn"> Order This Package </button></a>
				</td>
				</tr>
				
				<% } %>
		</table>
		</div>
		<br> <br> <br> <br> <br>

		<%- include("footer")%>

	</body>
</html>